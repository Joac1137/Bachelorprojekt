Todo:
Optimization is not optimized
Linear System of equations for weak selection

